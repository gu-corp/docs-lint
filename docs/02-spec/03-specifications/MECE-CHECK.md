# MECEチェック仕様

**バージョン**: 2.0.0
**更新日**: 2026-02-18

---

## 概要

`review spec` コマンドに含まれるMECE（Mutually Exclusive, Collectively Exhaustive）チェック機能の仕様を定義します。

## MECEとは

MECE（ミーシー）は、マッキンゼーが提唱した論理的思考フレームワークです。

| 原則 | 意味 | ドキュメントへの適用 |
|------|------|---------------------|
| **Mutually Exclusive**（相互排他） | 重複がない | 同じ内容が複数箇所に書かれていない |
| **Collectively Exhaustive**（完全網羅） | 漏れがない | 実装に必要な情報がすべて記載されている |

## チェック観点

### 相互排他性（ME）チェック

**目的**: 仕様の重複・矛盾を検出する

#### チェック項目

| ID | チェック内容 | 重要度 |
|----|-------------|--------|
| ME-001 | 同一機能が複数ファイルで定義されていないか | 高 |
| ME-002 | 異なるファイル間で矛盾する記述がないか | 高 |
| ME-003 | 用語の定義が一貫しているか | 中 |
| ME-004 | 責務の境界が明確に分離されているか | 中 |
| ME-005 | 同じエラーコードが複数箇所で定義されていないか | 低 |

#### 検出パターン例

```markdown
# 問題例1: 機能の重複定義

## ファイルA: API.md
認証はJWTトークンを使用する。トークンの有効期限は24時間。

## ファイルB: AUTH.md
認証にはJWTを採用。有効期限は12時間とする。
→ 有効期限が矛盾している
```

```markdown
# 問題例2: 責務の重複

## ファイルA: VALIDATION.md
入力値のバリデーションはControllerで行う。

## ファイルB: CONTROLLER.md
バリデーションはServiceレイヤーで実施する。
→ バリデーションの責務が不明確
```

### 完全網羅性（CE）チェック

**目的**: 仕様の漏れを検出する

#### チェック項目

| ID | チェック内容 | 重要度 |
|----|-------------|--------|
| CE-001 | すべての機能要件に対応する設計があるか | 高 |
| CE-002 | エラーケースが網羅されているか | 高 |
| CE-003 | 境界値・エッジケースが定義されているか | 中 |
| CE-004 | 状態遷移がすべて定義されているか | 中 |
| CE-005 | 外部連携の異常系が考慮されているか | 中 |
| CE-006 | セキュリティ要件が漏れなく記載されているか | 高 |
| CE-007 | 非機能要件（性能、可用性等）が定義されているか | 中 |

#### 検出パターン例

```markdown
# 問題例1: エラーケースの漏れ

## 現状の記述
ユーザー登録APIは以下のエラーを返す：
- 400: バリデーションエラー
- 409: メールアドレス重複

## 不足している可能性
- 500: 内部サーバーエラー
- 503: サービス利用不可
- 429: レート制限超過
```

```markdown
# 問題例2: 状態遷移の漏れ

## 現状の記述
注文ステータス: 作成済み → 支払い済み → 発送済み → 完了

## 不足している可能性
- キャンセル状態への遷移
- 返品状態
- 各状態からの遷移条件
```

## AIプロンプト構造

`review spec` 実行時に生成されるMECEチェックプロンプトの構造：

```text
## MECE（相互排他・完全網羅）チェック

ドキュメント全体がMECE原則に従っているかを評価してください。

### Mutually Exclusive（相互排他性）チェック
**観点**: 「同じ内容が複数箇所に書かれていないか？矛盾する記述がないか？」

以下の点を確認してください：
1. 機能定義の重複
2. 設計決定の矛盾
3. 用語定義の不一致
4. 責務境界の曖昧さ

### Collectively Exhaustive（完全網羅性）チェック
**観点**: 「実装に必要な情報が漏れなく記載されているか？」

以下の観点で漏れを確認してください：
1. 機能網羅性
2. 状態網羅性
3. エラー網羅性
4. 外部連携網羅性

### 出力形式
| 観点 | 評価 | 指摘事項 |
|------|------|----------|
| 相互排他性 | A/B/C/D | ... |
| 完全網羅性 | A/B/C/D | ... |
```

## 評価基準

| 評価 | 基準 |
|------|------|
| A | 問題なし、または軽微な改善提案のみ |
| B | 小規模な重複・漏れあり（実装に支障なし） |
| C | 中規模な問題あり（実装前に修正推奨） |
| D | 重大な矛盾・漏れあり（実装不可） |

## 使用方法

```bash
# 仕様書のMECEチェックを含むAIレビューを実行
docs-lint review spec

# プロンプトのみ生成（API呼び出しなし）
docs-lint review spec > review-prompt.md

# APIを直接呼び出し
docs-lint review spec --api

# 設計・実装整合性に焦点を当てる
docs-lint review spec --design
```

## 制限事項

- MECEチェックはAIによるヒューリスティックな評価です
- 完全な網羅性の保証はできません
- ドメイン知識に依存する判断は人間のレビューが必要です

---

## 関連ドキュメント

- [CLIリファレンス](../../03-guide/CLI.md)
- [機能要件](../01-requirements/01-functional/REQUIREMENTS.md)
- [アーキテクチャ設計](../02-architecture/ARCHITECTURE.md)
